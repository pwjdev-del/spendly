<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2685.2">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #4689cc; -webkit-text-stroke: #4689cc}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #8cd3fe; -webkit-text-stroke: #8cd3fe}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #c27e65; -webkit-text-stroke: #c27e65}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #cacaca; -webkit-text-stroke: #cacaca; min-height: 16.0px}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #6d7378; -webkit-text-stroke: #6d7378}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #71c083; -webkit-text-stroke: #71c083}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #a34f83; -webkit-text-stroke: #a34f83}
    span.s1 {font-kerning: none; background-color: #171818}
    span.s2 {font-kerning: none; color: #8cd3fe; background-color: #171818; -webkit-text-stroke: 0px #8cd3fe}
    span.s3 {font-kerning: none; color: #6d6d6d; background-color: #171818; -webkit-text-stroke: 0px #6d6d6d}
    span.s4 {font-kerning: none; color: #cacaca; background-color: #171818; -webkit-text-stroke: 0px #cacaca}
    span.s5 {font-kerning: none; color: #c27e65; background-color: #171818; -webkit-text-stroke: 0px #c27e65}
    span.s6 {font-kerning: none; color: #4689cc; background-color: #171818; -webkit-text-stroke: 0px #4689cc}
    span.s7 {font-kerning: none; color: #36c0a0; background-color: #171818; -webkit-text-stroke: 0px #36c0a0}
    span.s8 {font-kerning: none; color: #d4d4d4; background-color: #171818; -webkit-text-stroke: 0px #d4d4d4}
    span.s9 {font-kerning: none; color: #71c083; background-color: #171818; -webkit-text-stroke: 0px #71c083}
    span.s10 {font-kerning: none}
    span.s11 {font-kerning: none; color: #a7c598; background-color: #171818; -webkit-text-stroke: 0px #a7c598}
    span.s12 {font-kerning: none; color: #b76ff7; background-color: #171818; -webkit-text-stroke: 0px #b76ff7}
    span.s13 {font-kerning: none; color: #a34f83; background-color: #171818; -webkit-text-stroke: 0px #a34f83}
    span.s14 {font-kerning: none; color: #f67c30; background-color: #171818; -webkit-text-stroke: 0px #f67c30}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE</span><span class="s2"> html</span><span class="s1">&gt;</span></p>
<p class="p1"><span class="s3">&lt;</span><span class="s1">html</span><span class="s4"> </span><span class="s2">lang</span><span class="s3">=</span><span class="s5">"en"</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s1">charset</span><span class="s3">=</span><span class="s5">"UTF-8"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">meta</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"viewport"</span><span class="s4"> </span><span class="s2">content</span><span class="s3">=</span><span class="s1">"width=device-width, initial-scale=1.0"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">title</span><span class="s3">&gt;</span><span class="s1">Derivative Calculator</span><span class="s3">&lt;/</span><span class="s6">title</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdn.tailwindcss.com/"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">link</span><span class="s4"> </span><span class="s2">rel</span><span class="s3">=</span><span class="s1">"preconnect"</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"https://fonts.googleapis.com"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">link</span><span class="s4"> </span><span class="s2">rel</span><span class="s3">=</span><span class="s1">"preconnect"</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"https://fonts.gstatic.com"</span><span class="s4"> </span><span class="s2">crossorigin</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">link</span><span class="s4"> </span><span class="s2">href</span><span class="s3">=</span><span class="s1">"https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap"</span><span class="s4"> </span><span class="s2">rel</span><span class="s3">=</span><span class="s1">"stylesheet"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s7">MathJax</span><span class="s1"> </span><span class="s8">=</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>tex</span><span class="s8">:</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">          </span>inlineMath</span><span class="s8">:</span><span class="s1"> </span><span class="s8">[[</span><span class="s9">'$'</span><span class="s8">,</span><span class="s1"> </span><span class="s9">'$'</span><span class="s8">],</span><span class="s1"> </span><span class="s8">[</span><span class="s9">'\\('</span><span class="s8">,</span><span class="s1"> </span><span class="s9">'\\)'</span><span class="s8">]]</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">      </span></span><span class="s8">};</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">script</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"MathJax-script"</span><span class="s4"> </span><span class="s2">async</span><span class="s4"> </span><span class="s2">src</span><span class="s3">=</span><span class="s1">"https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"</span><span class="s3">&gt;&lt;/</span><span class="s6">script</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">body</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> </span><span class="s2">font-family:</span><span class="s1"> </span><span class="s9">'Inter'</span><span class="s8">,</span><span class="s1"> </span><span class="s5">sans-serif</span><span class="s8">;</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s6">#math-keyboard</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s1">grid-template-columns:</span><span class="s4"> </span><span class="s5">repeat(</span><span class="s11">5</span><span class="s8">,</span><span class="s4"> </span><span class="s11">1fr</span><span class="s5">)</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">.key</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> @apply flex items-center justify-center h-12 bg-gray-200 rounded-lg text-lg font-semibold text-gray-800 </span><span class="s2">active:</span><span class="s5">bg-gray-300</span><span class="s1"> </span><span class="s5">transition-colors</span><span class="s1"> </span><span class="s5">duration-150</span><span class="s8">;</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">.key.op-key</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> @apply bg-blue-500 text-white </span><span class="s2">active:</span><span class="s5">bg-blue-600</span><span class="s8">;</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">.key.fn-key</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> @apply bg-gray-700 text-white </span><span class="s2">active:</span><span class="s5">bg-gray-800</span><span class="s8">;</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s6">.calculator-section</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s2">transition:</span><span class="s4"> </span><span class="s1">opacity</span><span class="s4"> </span><span class="s11">0.3s</span><span class="s4"> </span><span class="s1">ease-in-out</span><span class="s8">,</span><span class="s4"> </span><span class="s1">transform</span><span class="s4"> </span><span class="s11">0.3s</span><span class="s4"> </span><span class="s1">ease-in-out</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p2"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s6">.hidden-section</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s1">opacity:</span><span class="s4"> </span><span class="s11">0</span><span class="s8">;</span><span class="s4"> </span><span class="s1">transform:</span><span class="s4"> </span><span class="s5">scale(</span><span class="s11">0.95</span><span class="s5">)</span><span class="s8">;</span><span class="s4"> </span><span class="s1">pointer-events:</span><span class="s4"> </span><span class="s5">none</span><span class="s8">;</span><span class="s4"> </span><span class="s1">position:</span><span class="s4"> </span><span class="s5">absolute</span><span class="s8">;</span><span class="s4"> </span><span class="s1">width:</span><span class="s4"> </span><span class="s11">100%</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">.math-preview</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> @apply p-4 bg-gray-50 border border-gray-300 rounded-lg min-h-[70px] flex items-center justify-center text-2xl text-gray-800 cursor-pointer transition; </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">.math-preview:hover</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> </span><span class="s2">border-color:</span><span class="s1"> #3b82f6</span><span class="s8">;</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.expression-input-wrapper</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s2">position:</span><span class="s4"> </span><span class="s5">relative</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">.expression-input</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> @apply w-full pl-3 pr-8 py-2 bg-white border border-t-0 border-gray-300 rounded-b-lg -mt-1 text-center text-sm text-gray-600 </span><span class="s2">focus:</span><span class="s5">outline-none</span><span class="s1"> </span><span class="s5">focus</span><span class="s1">:</span><span class="s5">ring-2</span><span class="s1"> </span><span class="s5">focus</span><span class="s1">:</span><span class="s5">ring-blue-500</span><span class="s1"> </span><span class="s5">transition</span><span class="s8">;</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s6">.clear-btn</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> @apply absolute right-2 top-1/2 -translate-y-1/2 text-gray-400 </span><span class="s2">hover:</span><span class="s5">text-gray-600</span><span class="s1"> </span><span class="s5">transition</span><span class="s8">;</span><span class="s1"> </span><span class="s2">display:</span><span class="s1"> </span><span class="s5">none</span><span class="s8">;</span><span class="s1"> </span><span class="s2">background:</span><span class="s1"> </span><span class="s5">none</span><span class="s8">;</span><span class="s1"> </span><span class="s2">border:</span><span class="s1"> </span><span class="s5">none</span><span class="s8">;</span><span class="s1"> </span><span class="s2">font-size:</span><span class="s1"> </span><span class="s11">1.25rem</span><span class="s8">;</span><span class="s1"> </span><span class="s2">line-height:</span><span class="s1"> </span><span class="s11">1</span><span class="s8">;</span><span class="s1"> </span><span class="s2">cursor:</span><span class="s1"> </span><span class="s5">pointer</span><span class="s8">;</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">.expression-input:not</span><span class="s4">(</span><span class="s1">:placeholder-shown</span><span class="s4">) ~ </span><span class="s1">.clear-btn</span><span class="s4"> </span><span class="s8">{</span><span class="s4"> </span><span class="s2">display:</span><span class="s4"> </span><span class="s5">block</span><span class="s8">;</span><span class="s4"> </span><span class="s8">}</span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">style</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">head</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s3">&lt;</span><span class="s6">body</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-gray-100 flex items-center justify-center min-h-screen py-8"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full max-w-lg mx-auto"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"bg-white rounded-2xl shadow-lg p-6 sm:p-8 mb-4"</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">h1</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"text-2xl sm:text-3xl font-bold text-gray-800 text-center mb-4"</span><span class="s3">&gt;</span><span class="s4">Derivative Calculator</span><span class="s3">&lt;/</span><span class="s6">h1</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-center text-gray-500 mb-6"</span><span class="s3">&gt;</span><span class="s1">Click the box to start typing. Press Enter to calculate.</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"grid grid-cols-3 gap-2 mb-8 bg-gray-200 p-2 rounded-xl"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s3">&gt;&lt;</span><span class="s6">input</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"radio"</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"rule"</span><span class="s4"> </span><span class="s2">value</span><span class="s3">=</span><span class="s1">"standard"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"sr-only peer"</span><span class="s4"> </span><span class="s2">checked</span><span class="s3">&gt;&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"cursor-pointer text-center w-full py-2 px-3 rounded-lg text-gray-700 peer-checked:bg-blue-600 peer-checked:text-white peer-checked:shadow-md font-semibold transition-all duration-200"</span><span class="s3">&gt;</span><span class="s4">Standard</span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s3">&gt;&lt;</span><span class="s6">input</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"radio"</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"rule"</span><span class="s4"> </span><span class="s2">value</span><span class="s3">=</span><span class="s1">"product"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"sr-only peer"</span><span class="s3">&gt;&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"cursor-pointer text-center w-full py-2 px-3 rounded-lg text-gray-700 peer-checked:bg-blue-600 peer-checked:text-white peer-checked:shadow-md font-semibold transition-all duration-200"</span><span class="s3">&gt;</span><span class="s4">Product</span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s3">&gt;&lt;</span><span class="s6">input</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"radio"</span><span class="s4"> </span><span class="s2">name</span><span class="s3">=</span><span class="s1">"rule"</span><span class="s4"> </span><span class="s2">value</span><span class="s3">=</span><span class="s1">"quotient"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"sr-only peer"</span><span class="s3">&gt;&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"cursor-pointer text-center w-full py-2 px-3 rounded-lg text-gray-700 peer-checked:bg-blue-600 peer-checked:text-white peer-checked:shadow-md font-semibold transition-all duration-200"</span><span class="s3">&gt;</span><span class="s4">Quotient</span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"relative"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"standard-calculator"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"calculator-section"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"space-y-4"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s4"> </span><span class="s2">for</span><span class="s3">=</span><span class="s1">"function-input"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"block text-sm font-medium text-gray-600 mb-1"</span><span class="s3">&gt;</span><span class="s4">Function</span><span class="s3">&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"expression-input-wrapper"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"function-preview"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"math-preview"</span><span class="s4"> </span><span class="s2">onclick</span><span class="s3">=</span><span class="s1">"document.getElementById('function-input').focus();"</span><span class="s3">&gt;</span><span class="s4">$f(x)$</span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">input</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"text"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"function-input"</span><span class="s4"> </span><span class="s2">placeholder</span><span class="s3">=</span><span class="s1">"Type your expression here..."</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"expression-input"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"clear-btn"</span><span class="s4"> </span><span class="s2">data-input</span><span class="s3">=</span><span class="s1">"function-input"</span><span class="s4"> </span><span class="s2">data-preview</span><span class="s3">=</span><span class="s1">"function-preview"</span><span class="s3">&gt;</span><span class="s4">×</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"calculate-derivative"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 active:scale-95 transition-transform shadow-sm"</span><span class="s3">&gt;</span><span class="s4">Calculate</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"derivative-answer"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full bg-gray-50 p-4 rounded-lg text-center min-h-[80px] flex flex-col justify-center relative answer-box"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"product-calculator"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"calculator-section hidden-section"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                     </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-center font-semibold text-gray-600 mb-2"</span><span class="s3">&gt;</span><span class="s1">$\frac{d}{dx} [f(x) \cdot g(x)]$</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"space-y-4"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s4"> </span><span class="s2">for</span><span class="s3">=</span><span class="s1">"product-f"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"block text-sm font-medium text-gray-600 mb-1"</span><span class="s3">&gt;</span><span class="s4">Function f(x)</span><span class="s3">&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"expression-input-wrapper"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"product-f-preview"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"math-preview"</span><span class="s4"> </span><span class="s2">onclick</span><span class="s3">=</span><span class="s1">"document.getElementById('product-f').focus();"</span><span class="s3">&gt;</span><span class="s4">$f(x)$</span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">input</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"text"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"product-f"</span><span class="s4"> </span><span class="s2">placeholder</span><span class="s3">=</span><span class="s1">"Type first function..."</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"expression-input"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"clear-btn"</span><span class="s4"> </span><span class="s2">data-input</span><span class="s3">=</span><span class="s1">"product-f"</span><span class="s4"> </span><span class="s2">data-preview</span><span class="s3">=</span><span class="s1">"product-f-preview"</span><span class="s3">&gt;</span><span class="s4">×</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s4"> </span><span class="s2">for</span><span class="s3">=</span><span class="s1">"product-g"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"block text-sm font-medium text-gray-600 mb-1"</span><span class="s3">&gt;</span><span class="s4">Function g(x)</span><span class="s3">&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"expression-input-wrapper"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"product-g-preview"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"math-preview"</span><span class="s4"> </span><span class="s2">onclick</span><span class="s3">=</span><span class="s1">"document.getElementById('product-g').focus();"</span><span class="s3">&gt;</span><span class="s4">$g(x)$</span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">input</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"text"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"product-g"</span><span class="s4"> </span><span class="s2">placeholder</span><span class="s3">=</span><span class="s1">"Type second function..."</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"expression-input"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"clear-btn"</span><span class="s4"> </span><span class="s2">data-input</span><span class="s3">=</span><span class="s1">"product-g"</span><span class="s4"> </span><span class="s2">data-preview</span><span class="s3">=</span><span class="s1">"product-g-preview"</span><span class="s3">&gt;</span><span class="s4">×</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"calculate-product"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 active:scale-95 transition-transform shadow-sm"</span><span class="s3">&gt;</span><span class="s4">Calculate</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"product-answer"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full bg-gray-50 p-4 rounded-lg text-center min-h-[80px] flex flex-col justify-center relative answer-box"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"quotient-calculator"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"calculator-section hidden-section"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">p</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"text-center font-semibold text-gray-600 mb-2"</span><span class="s3">&gt;</span><span class="s1">$\frac{d}{dx} \left[ \frac{f(x)}{g(x)} \right]$</span><span class="s3">&lt;/</span><span class="s6">p</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"space-y-4"</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                         </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s4"> </span><span class="s2">for</span><span class="s3">=</span><span class="s1">"quotient-f"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"block text-sm font-medium text-gray-600 mb-1"</span><span class="s3">&gt;</span><span class="s4">Numerator f(x)</span><span class="s3">&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"expression-input-wrapper"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"quotient-f-preview"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"math-preview"</span><span class="s4"> </span><span class="s2">onclick</span><span class="s3">=</span><span class="s1">"document.getElementById('quotient-f').focus();"</span><span class="s3">&gt;</span><span class="s4">$f(x)$</span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">input</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"text"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"quotient-f"</span><span class="s4"> </span><span class="s2">placeholder</span><span class="s3">=</span><span class="s1">"Type numerator..."</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"expression-input"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"clear-btn"</span><span class="s4"> </span><span class="s2">data-input</span><span class="s3">=</span><span class="s1">"quotient-f"</span><span class="s4"> </span><span class="s2">data-preview</span><span class="s3">=</span><span class="s1">"quotient-f-preview"</span><span class="s3">&gt;</span><span class="s4">×</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">label</span><span class="s4"> </span><span class="s2">for</span><span class="s3">=</span><span class="s1">"quotient-g"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"block text-sm font-medium text-gray-600 mb-1"</span><span class="s3">&gt;</span><span class="s4">Denominator g(x)</span><span class="s3">&lt;/</span><span class="s6">label</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"expression-input-wrapper"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"quotient-g-preview"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"math-preview"</span><span class="s4"> </span><span class="s2">onclick</span><span class="s3">=</span><span class="s1">"document.getElementById('quotient-g').focus();"</span><span class="s3">&gt;</span><span class="s4">$g(x)$</span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">input</span><span class="s4"> </span><span class="s2">type</span><span class="s3">=</span><span class="s1">"text"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"quotient-g"</span><span class="s4"> </span><span class="s2">placeholder</span><span class="s3">=</span><span class="s1">"Type denominator..."</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"expression-input"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                                </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"clear-btn"</span><span class="s4"> </span><span class="s2">data-input</span><span class="s3">=</span><span class="s1">"quotient-g"</span><span class="s4"> </span><span class="s2">data-preview</span><span class="s3">=</span><span class="s1">"quotient-g-preview"</span><span class="s3">&gt;</span><span class="s4">×</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"calculate-quotient"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full bg-blue-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-blue-700 active:scale-95 transition-transform shadow-sm"</span><span class="s3">&gt;</span><span class="s4">Calculate</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">                        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"quotient-answer"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"w-full bg-gray-50 p-4 rounded-lg text-center min-h-[80px] flex flex-col justify-center relative answer-box"</span><span class="s3">&gt;&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;</span><span class="s6">div</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"math-keyboard"</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"grid gap-2 p-4 bg-white rounded-2xl shadow-lg"</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"key fn-key"</span><span class="s4"> </span><span class="s2">data-value</span><span class="s3">=</span><span class="s1">"\sin"</span><span class="s3">&gt;</span><span class="s4">sin</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"key fn-key"</span><span class="s4"> </span><span class="s2">data-value</span><span class="s3">=</span><span class="s1">"\cos"</span><span class="s3">&gt;</span><span class="s4">cos</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"key fn-key"</span><span class="s4"> </span><span class="s2">data-value</span><span class="s3">=</span><span class="s1">"\tan"</span><span class="s3">&gt;</span><span class="s4">tan</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"key"</span><span class="s3">&gt;</span><span class="s1">(</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"key"</span><span class="s3">&gt;</span><span class="s1">)</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"key fn-key"</span><span class="s4"> </span><span class="s2">data-value</span><span class="s3">=</span><span class="s1">"\csc"</span><span class="s3">&gt;</span><span class="s4">csc</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"key fn-key"</span><span class="s4"> </span><span class="s2">data-value</span><span class="s3">=</span><span class="s1">"\sec"</span><span class="s3">&gt;</span><span class="s4">sec</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"key fn-key"</span><span class="s4"> </span><span class="s2">data-value</span><span class="s3">=</span><span class="s1">"\cot"</span><span class="s3">&gt;</span><span class="s4">cot</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"key fn-key"</span><span class="s4"> </span><span class="s2">data-value</span><span class="s3">=</span><span class="s1">"\ln"</span><span class="s3">&gt;</span><span class="s4">ln</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"key fn-key"</span><span class="s1"> </span><span class="s2">data-value</span><span class="s3">=</span><span class="s5">"e^"</span><span class="s3">&gt;</span><span class="s1">eˣ</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"key"</span><span class="s3">&gt;</span><span class="s1">7</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"key"</span><span class="s3">&gt;</span><span class="s1">8</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"key"</span><span class="s3">&gt;</span><span class="s1">9</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"key"</span><span class="s3">&gt;</span><span class="s1">x</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"key"</span><span class="s3">&gt;</span><span class="s1">y</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"key"</span><span class="s3">&gt;</span><span class="s1">4</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"key"</span><span class="s3">&gt;</span><span class="s1">5</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"key"</span><span class="s3">&gt;</span><span class="s1">6</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"key op-key"</span><span class="s3">&gt;</span><span class="s1">+</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"key op-key"</span><span class="s3">&gt;</span><span class="s1">-</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"key"</span><span class="s3">&gt;</span><span class="s1">1</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"key"</span><span class="s3">&gt;</span><span class="s1">2</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"key"</span><span class="s3">&gt;</span><span class="s1">3</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"key"</span><span class="s1"> </span><span class="s2">data-value</span><span class="s3">=</span><span class="s5">"^"</span><span class="s3">&gt;</span><span class="s1">xⁿ</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s1"> </span><span class="s2">id</span><span class="s3">=</span><span class="s5">"sqrt-key"</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"key"</span><span class="s3">&gt;</span><span class="s1">√</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"key col-span-2"</span><span class="s3">&gt;</span><span class="s4">0</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s1"> </span><span class="s2">class</span><span class="s3">=</span><span class="s5">"key"</span><span class="s3">&gt;</span><span class="s1">.</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p3"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s3">&lt;</span><span class="s6">button</span><span class="s4"> </span><span class="s2">class</span><span class="s3">=</span><span class="s1">"key col-span-2 op-key"</span><span class="s4"> </span><span class="s2">id</span><span class="s3">=</span><span class="s1">"backspace-key"</span><span class="s3">&gt;</span><span class="s4">⌫</span><span class="s3">&lt;/</span><span class="s6">button</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s6">div</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">    </span></span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- DOM Elements ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> ruleRadios </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">querySelectorAll</span><span class="s8">(</span><span class="s9">'input[name="rule"]'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> calculators </span><span class="s8">=</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> standard</span><span class="s8">:</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'standard-calculator'</span><span class="s8">),</span><span class="s1"> product</span><span class="s8">:</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'product-calculator'</span><span class="s8">),</span><span class="s1"> quotient</span><span class="s8">:</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'quotient-calculator'</span><span class="s8">)</span><span class="s1"> </span><span class="s8">};</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">let</span><span class="s1"> activeInput </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'function-input'</span><span class="s8">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Input fields and their calculate buttons</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> inputsAndButtons </span><span class="s8">=</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">'function-input'</span><span class="s8">:</span><span class="s4"> </span><span class="s1">'calculate-derivative'</span><span class="s8">,</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">'product-f'</span><span class="s8">:</span><span class="s4"> </span><span class="s1">'calculate-product'</span><span class="s8">,</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">'product-g'</span><span class="s8">:</span><span class="s4"> </span><span class="s1">'calculate-product'</span><span class="s8">,</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">'quotient-f'</span><span class="s8">:</span><span class="s4"> </span><span class="s1">'calculate-quotient'</span><span class="s8">,</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">'quotient-g'</span><span class="s8">:</span><span class="s4"> </span><span class="s1">'calculate-quotient'</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">};</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> keyboard </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'math-keyboard'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">const</span><span class="s1"> backspaceKey </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'backspace-key'</span><span class="s8">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Initial State ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>document</span><span class="s8">.</span><span class="s1">querySelectorAll</span><span class="s8">(</span><span class="s9">'.answer-box'</span><span class="s8">).</span><span class="s1">forEach</span><span class="s8">(</span><span class="s1">box </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>box</span><span class="s8">.</span><span class="s4">innerHTML </span><span class="s8">=</span><span class="s4"> </span><span class="s1">`&lt;p class="font-medium text-gray-500"&gt;Your answer will appear here.&lt;/p&gt;`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">});</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- MathJax Typesetting Function ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> typeset</span><span class="s8">(</span><span class="s1">element</span><span class="s8">,</span><span class="s1"> text</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>element</span><span class="s8">.</span><span class="s1">innerHTML </span><span class="s8">=</span><span class="s1"> </span><span class="s9">'$'</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> text </span><span class="s8">+</span><span class="s1"> </span><span class="s9">'$'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s7">MathJax</span><span class="s8">.</span><span class="s1">typesetPromise</span><span class="s8">([</span><span class="s1">element</span><span class="s8">]).</span><span class="s12">catch</span><span class="s8">((</span><span class="s1">err</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> console</span><span class="s8">.</span><span class="s1">log</span><span class="s8">(</span><span class="s9">'MathJax Error:'</span><span class="s8">,</span><span class="s1"> err</span><span class="s8">.</span><span class="s1">message</span><span class="s8">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Event Listeners ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>ruleRadios</span><span class="s8">.</span><span class="s1">forEach</span><span class="s8">(</span><span class="s1">radio </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>radio</span><span class="s8">.</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'change'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">(</span><span class="s1">event</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> selectedRule </span><span class="s8">=</span><span class="s1"> event</span><span class="s8">.</span><span class="s1">target</span><span class="s8">.</span><span class="s1">value</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">for</span><span class="s1"> </span><span class="s8">(</span><span class="s12">const</span><span class="s1"> rule </span><span class="s12">in</span><span class="s1"> calculators</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>calculators</span><span class="s8">[</span><span class="s1">rule</span><span class="s8">].</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">toggle</span><span class="s8">(</span><span class="s9">'hidden-section'</span><span class="s8">,</span><span class="s1"> rule </span><span class="s8">!==</span><span class="s1"> selectedRule</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s8">(</span><span class="s1">selectedRule </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'standard'</span><span class="s8">)</span><span class="s1"> activeInput </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'function-input'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s8">(</span><span class="s1">selectedRule </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'product'</span><span class="s8">)</span><span class="s1"> activeInput </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'product-f'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s8">(</span><span class="s1">selectedRule </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'quotient'</span><span class="s8">)</span><span class="s1"> activeInput </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'quotient-f'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>activeInput</span><span class="s8">.</span><span class="s1">focus</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">});</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>document</span><span class="s8">.</span><span class="s1">querySelectorAll</span><span class="s8">(</span><span class="s9">'.expression-input'</span><span class="s8">).</span><span class="s1">forEach</span><span class="s8">(</span><span class="s1">input </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s12">const</span><span class="s1"> previewId </span><span class="s8">=</span><span class="s1"> input</span><span class="s8">.</span><span class="s1">parentElement</span><span class="s8">.</span><span class="s1">querySelector</span><span class="s8">(</span><span class="s9">'.math-preview'</span><span class="s8">).</span><span class="s1">id</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s12">const</span><span class="s1"> preview </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s1">previewId</span><span class="s8">);</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>input</span><span class="s8">.</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'focus'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> activeInput </span><span class="s8">=</span><span class="s1"> input</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>input</span><span class="s8">.</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'input'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">let</span><span class="s1"> text </span><span class="s8">=</span><span class="s1"> input</span><span class="s8">.</span><span class="s1">value</span><span class="s8">.</span><span class="s1">replace</span><span class="s8">(</span><span class="s13">/√\(/</span><span class="s12">g</span><span class="s8">,</span><span class="s1"> </span><span class="s9">'\\sqrt('</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>typeset</span><span class="s8">(</span><span class="s1">preview</span><span class="s8">,</span><span class="s1"> text </span><span class="s8">||</span><span class="s1"> </span><span class="s9">'...'</span><span class="s8">);</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                </span>input</span><span class="s8">.</span><span class="s4">classList</span><span class="s8">.</span><span class="s4">remove</span><span class="s8">(</span><span class="s9">'border-red-500'</span><span class="s8">);</span><span class="s4"> </span><span class="s1">// Remove error highlight on new input</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">});</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s1">// Enter key to calculate</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>input</span><span class="s8">.</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'keydown'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">(</span><span class="s1">event</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">event</span><span class="s8">.</span><span class="s1">key </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'Enter'</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>event</span><span class="s8">.</span><span class="s1">preventDefault</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s1">inputsAndButtons</span><span class="s8">[</span><span class="s1">input</span><span class="s8">.</span><span class="s1">id</span><span class="s8">]).</span><span class="s1">click</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">});</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// Clear buttons</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>document</span><span class="s8">.</span><span class="s1">querySelectorAll</span><span class="s8">(</span><span class="s9">'.clear-btn'</span><span class="s8">).</span><span class="s1">forEach</span><span class="s8">(</span><span class="s1">btn </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>btn</span><span class="s8">.</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'click'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> inputEl </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s1">btn</span><span class="s8">.</span><span class="s1">dataset</span><span class="s8">.</span><span class="s1">input</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> previewEl </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s1">btn</span><span class="s8">.</span><span class="s1">dataset</span><span class="s8">.</span><span class="s1">preview</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>inputEl</span><span class="s8">.</span><span class="s1">value </span><span class="s8">=</span><span class="s1"> </span><span class="s9">''</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>typeset</span><span class="s8">(</span><span class="s1">previewEl</span><span class="s8">,</span><span class="s1"> </span><span class="s9">'...'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>inputEl</span><span class="s8">.</span><span class="s1">focus</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>inputEl</span><span class="s8">.</span><span class="s1">dispatchEvent</span><span class="s8">(</span><span class="s12">new</span><span class="s1"> </span><span class="s7">Event</span><span class="s8">(</span><span class="s9">'input'</span><span class="s8">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">});</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>keyboard</span><span class="s8">.</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'click'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">(</span><span class="s1">event</span><span class="s8">)</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> target </span><span class="s8">=</span><span class="s1"> event</span><span class="s8">.</span><span class="s1">target</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">target</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">contains</span><span class="s8">(</span><span class="s9">'key'</span><span class="s8">)</span><span class="s1"> </span><span class="s8">||</span><span class="s1"> target</span><span class="s8">.</span><span class="s1">id </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'backspace-key'</span><span class="s8">)</span><span class="s1"> </span><span class="s12">return</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> value </span><span class="s8">=</span><span class="s1"> target</span><span class="s8">.</span><span class="s1">dataset</span><span class="s8">.</span><span class="s1">value </span><span class="s8">||</span><span class="s1"> target</span><span class="s8">.</span><span class="s1">textContent</span><span class="s8">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">target</span><span class="s8">.</span><span class="s1">id </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'sqrt-key'</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>insertFunctionWithCursor</span><span class="s8">(</span><span class="s9">'\\sqrt'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">target</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">contains</span><span class="s8">(</span><span class="s9">'fn-key'</span><span class="s8">))</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>insertFunctionWithCursor</span><span class="s8">(</span><span class="s1">value</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>insertAtCursor</span><span class="s8">(</span><span class="s1">value</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span>activeInput</span><span class="s8">.</span><span class="s1">dispatchEvent</span><span class="s8">(</span><span class="s12">new</span><span class="s1"> </span><span class="s7">Event</span><span class="s8">(</span><span class="s9">'input'</span><span class="s8">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">});</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>backspaceKey</span><span class="s8">.</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'click'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s12">const</span><span class="s1"> start </span><span class="s8">=</span><span class="s1"> activeInput</span><span class="s8">.</span><span class="s1">selectionStart</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s12">const</span><span class="s1"> end </span><span class="s8">=</span><span class="s1"> activeInput</span><span class="s8">.</span><span class="s1">selectionEnd</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">end </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">start </span><span class="s8">===</span><span class="s1"> end</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                     </span>activeInput</span><span class="s8">.</span><span class="s1">value </span><span class="s8">=</span><span class="s1"> activeInput</span><span class="s8">.</span><span class="s1">value</span><span class="s8">.</span><span class="s1">substring</span><span class="s8">(</span><span class="s14">0</span><span class="s8">,</span><span class="s1"> start </span><span class="s8">-</span><span class="s1"> </span><span class="s14">1</span><span class="s8">)</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> activeInput</span><span class="s8">.</span><span class="s1">value</span><span class="s8">.</span><span class="s1">substring</span><span class="s8">(</span><span class="s1">end</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                     </span>activeInput</span><span class="s8">.</span><span class="s1">selectionStart </span><span class="s8">=</span><span class="s1"> activeInput</span><span class="s8">.</span><span class="s1">selectionEnd </span><span class="s8">=</span><span class="s1"> start </span><span class="s8">-</span><span class="s1"> </span><span class="s14">1</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span></span><span class="s8">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                     </span>activeInput</span><span class="s8">.</span><span class="s1">value </span><span class="s8">=</span><span class="s1"> activeInput</span><span class="s8">.</span><span class="s1">value</span><span class="s8">.</span><span class="s1">substring</span><span class="s8">(</span><span class="s14">0</span><span class="s8">,</span><span class="s1"> start</span><span class="s8">)</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> activeInput</span><span class="s8">.</span><span class="s1">value</span><span class="s8">.</span><span class="s1">substring</span><span class="s8">(</span><span class="s1">end</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                     </span>activeInput</span><span class="s8">.</span><span class="s1">selectionStart </span><span class="s8">=</span><span class="s1"> activeInput</span><span class="s8">.</span><span class="s1">selectionEnd </span><span class="s8">=</span><span class="s1"> start</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span>activeInput</span><span class="s8">.</span><span class="s1">focus</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span>activeInput</span><span class="s8">.</span><span class="s1">dispatchEvent</span><span class="s8">(</span><span class="s12">new</span><span class="s1"> </span><span class="s7">Event</span><span class="s8">(</span><span class="s9">'input'</span><span class="s8">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">});</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Calculation Handlers ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'calculate-derivative'</span><span class="s8">).</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'click'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> input </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'function-input'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> answerBox </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'derivative-answer'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>handleCalculation</span><span class="s8">(</span><span class="s1">input</span><span class="s8">,</span><span class="s1"> answerBox</span><span class="s8">,</span><span class="s1"> expr </span><span class="s8">=&gt;</span><span class="s1"> calculateDerivative</span><span class="s8">(</span><span class="s1">expr</span><span class="s8">));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">});</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'calculate-product'</span><span class="s8">).</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'click'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> f_input </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'product-f'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> g_input </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'product-g'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> answerBox </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'product-answer'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> f </span><span class="s8">=</span><span class="s1"> f_input</span><span class="s8">.</span><span class="s1">value</span><span class="s8">.</span><span class="s1">trim</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> g </span><span class="s8">=</span><span class="s1"> g_input</span><span class="s8">.</span><span class="s1">value</span><span class="s8">.</span><span class="s1">trim</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">f</span><span class="s8">)</span><span class="s1"> </span><span class="s12">return</span><span class="s1"> displayError</span><span class="s8">(</span><span class="s1">answerBox</span><span class="s8">,</span><span class="s1"> </span><span class="s9">'Please enter f(x).'</span><span class="s8">,</span><span class="s1"> f_input</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">g</span><span class="s8">)</span><span class="s1"> </span><span class="s12">return</span><span class="s1"> displayError</span><span class="s8">(</span><span class="s1">answerBox</span><span class="s8">,</span><span class="s1"> </span><span class="s9">'Please enter g(x).'</span><span class="s8">,</span><span class="s1"> g_input</span><span class="s8">);</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">try</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> df </span><span class="s8">=</span><span class="s1"> calculateDerivative</span><span class="s8">(</span><span class="s1">f</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> dg </span><span class="s8">=</span><span class="s1"> calculateDerivative</span><span class="s8">(</span><span class="s1">g</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> result </span><span class="s8">=</span><span class="s1"> </span><span class="s9">`(</span><span class="s8">${</span><span class="s1">df</span><span class="s8">}</span><span class="s9">)(</span><span class="s8">${</span><span class="s1">g</span><span class="s8">}</span><span class="s9">) + (</span><span class="s8">${</span><span class="s1">f</span><span class="s8">}</span><span class="s9">)(</span><span class="s8">${</span><span class="s1">dg</span><span class="s8">}</span><span class="s9">)`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>displayResult</span><span class="s8">(</span><span class="s1">answerBox</span><span class="s8">,</span><span class="s1"> result</span><span class="s8">,</span><span class="s1"> </span><span class="s9">"f'(x)g(x) + f(x)g'(x)"</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span><span class="s1"> </span><span class="s12">catch</span><span class="s1"> </span><span class="s8">(</span><span class="s1">error</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> displayError</span><span class="s8">(</span><span class="s1">answerBox</span><span class="s8">,</span><span class="s1"> </span><span class="s9">"Calculation error."</span><span class="s8">);</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">});</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span>document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'calculate-quotient'</span><span class="s8">).</span><span class="s1">addEventListener</span><span class="s8">(</span><span class="s9">'click'</span><span class="s8">,</span><span class="s1"> </span><span class="s8">()</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> f_input </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'quotient-f'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> g_input </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'quotient-g'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> answerBox </span><span class="s8">=</span><span class="s1"> document</span><span class="s8">.</span><span class="s1">getElementById</span><span class="s8">(</span><span class="s9">'quotient-answer'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> f_str </span><span class="s8">=</span><span class="s1"> f_input</span><span class="s8">.</span><span class="s1">value</span><span class="s8">.</span><span class="s1">trim</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> g_str </span><span class="s8">=</span><span class="s1"> g_input</span><span class="s8">.</span><span class="s1">value</span><span class="s8">.</span><span class="s1">trim</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">f_str</span><span class="s8">)</span><span class="s1"> </span><span class="s12">return</span><span class="s1"> displayError</span><span class="s8">(</span><span class="s1">answerBox</span><span class="s8">,</span><span class="s1"> </span><span class="s9">'Please enter f(x).'</span><span class="s8">,</span><span class="s1"> f_input</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">g_str</span><span class="s8">)</span><span class="s1"> </span><span class="s12">return</span><span class="s1"> displayError</span><span class="s8">(</span><span class="s1">answerBox</span><span class="s8">,</span><span class="s1"> </span><span class="s9">'Please enter g(x).'</span><span class="s8">,</span><span class="s1"> g_input</span><span class="s8">);</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">try</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> df_str </span><span class="s8">=</span><span class="s1"> calculateDerivative</span><span class="s8">(</span><span class="s1">f_str</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> dg_str </span><span class="s8">=</span><span class="s1"> calculateDerivative</span><span class="s8">(</span><span class="s1">g_str</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">let</span><span class="s1"> numerator_str</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">try</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> f_poly </span><span class="s8">=</span><span class="s1"> parsePolynomial</span><span class="s8">(</span><span class="s1">f_str</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> g_poly </span><span class="s8">=</span><span class="s1"> parsePolynomial</span><span class="s8">(</span><span class="s1">g_str</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> df_poly </span><span class="s8">=</span><span class="s1"> parsePolynomial</span><span class="s8">(</span><span class="s1">df_str</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> dg_poly </span><span class="s8">=</span><span class="s1"> parsePolynomial</span><span class="s8">(</span><span class="s1">dg_str</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> term1 </span><span class="s8">=</span><span class="s1"> multiplyPolynomials</span><span class="s8">(</span><span class="s1">df_poly</span><span class="s8">,</span><span class="s1"> g_poly</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> term2 </span><span class="s8">=</span><span class="s1"> multiplyPolynomials</span><span class="s8">(</span><span class="s1">f_poly</span><span class="s8">,</span><span class="s1"> dg_poly</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> numerator_poly </span><span class="s8">=</span><span class="s1"> subtractPolynomials</span><span class="s8">(</span><span class="s1">term1</span><span class="s8">,</span><span class="s1"> term2</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>numerator_str </span><span class="s8">=</span><span class="s1"> formatPolynomial</span><span class="s8">(</span><span class="s1">numerator_poly</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span><span class="s1"> </span><span class="s12">catch</span><span class="s1"> </span><span class="s8">(</span><span class="s1">e</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>numerator_str </span><span class="s8">=</span><span class="s1"> </span><span class="s9">`(</span><span class="s8">${</span><span class="s1">df_str</span><span class="s8">}</span><span class="s9">)(</span><span class="s8">${</span><span class="s1">g_str</span><span class="s8">}</span><span class="s9">) - (</span><span class="s8">${</span><span class="s1">f_str</span><span class="s8">}</span><span class="s9">)(</span><span class="s8">${</span><span class="s1">dg_str</span><span class="s8">}</span><span class="s9">)`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> result </span><span class="s8">=</span><span class="s1"> </span><span class="s9">`\\frac{</span><span class="s8">${</span><span class="s1">numerator_str</span><span class="s8">}</span><span class="s9">}{(</span><span class="s8">${</span><span class="s1">g_str</span><span class="s8">}</span><span class="s9">)^2}`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>displayResult</span><span class="s8">(</span><span class="s1">answerBox</span><span class="s8">,</span><span class="s1"> result</span><span class="s8">,</span><span class="s1"> </span><span class="s9">"\\frac{f'g - fg'}{g^2}"</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span><span class="s1"> </span><span class="s12">catch</span><span class="s1"> </span><span class="s8">(</span><span class="s1">error</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> console</span><span class="s8">.</span><span class="s1">error</span><span class="s8">(</span><span class="s1">error</span><span class="s8">);</span><span class="s1"> displayError</span><span class="s8">(</span><span class="s1">answerBox</span><span class="s8">,</span><span class="s1"> </span><span class="s9">"Calculation error."</span><span class="s8">);</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">});</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> handleCalculation</span><span class="s8">(</span><span class="s1">inputEl</span><span class="s8">,</span><span class="s1"> answerEl</span><span class="s8">,</span><span class="s1"> calculationFn</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> expression </span><span class="s8">=</span><span class="s1"> inputEl</span><span class="s8">.</span><span class="s1">value</span><span class="s8">.</span><span class="s1">trim</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">expression</span><span class="s8">)</span><span class="s1"> </span><span class="s12">return</span><span class="s1"> displayError</span><span class="s8">(</span><span class="s1">answerEl</span><span class="s8">,</span><span class="s1"> </span><span class="s9">'Please enter a function.'</span><span class="s8">,</span><span class="s1"> inputEl</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">try</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> derivative </span><span class="s8">=</span><span class="s1"> calculationFn</span><span class="s8">(</span><span class="s1">expression</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>displayResult</span><span class="s8">(</span><span class="s1">answerEl</span><span class="s8">,</span><span class="s1"> derivative</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span><span class="s1"> </span><span class="s12">catch</span><span class="s1"> </span><span class="s8">(</span><span class="s1">error</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> console</span><span class="s8">.</span><span class="s1">error</span><span class="s8">(</span><span class="s1">error</span><span class="s8">);</span><span class="s1"> displayError</span><span class="s8">(</span><span class="s1">answerEl</span><span class="s8">,</span><span class="s1"> </span><span class="s9">"Sorry, I couldn't understand that function."</span><span class="s8">,</span><span class="s1"> inputEl</span><span class="s8">);</span><span class="s1"> </span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- POLYNOMIAL ALGEBRA ENGINE ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> parsePolynomial</span><span class="s8">(</span><span class="s1">expr</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s4"> </span><span class="s8">(</span><span class="s4">expr</span><span class="s8">.</span><span class="s4">match</span><span class="s8">(</span><span class="s1">/sin|cos|tan|sec|csc|cot|ln|e\^|y|sqrt/</span><span class="s8">))</span><span class="s4"> </span><span class="s12">throw</span><span class="s4"> </span><span class="s12">new</span><span class="s4"> </span><span class="s7">Error</span><span class="s8">(</span><span class="s9">"Not a simple polynomial of x"</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> processedExpr </span><span class="s8">=</span><span class="s1"> expr</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">processedExpr</span><span class="s8">.</span><span class="s1">startsWith</span><span class="s8">(</span><span class="s9">'('</span><span class="s8">)</span><span class="s1"> </span><span class="s8">&amp;&amp;</span><span class="s1"> processedExpr</span><span class="s8">.</span><span class="s1">endsWith</span><span class="s8">(</span><span class="s9">')'</span><span class="s8">))</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span>processedExpr </span><span class="s8">=</span><span class="s1"> processedExpr</span><span class="s8">.</span><span class="s1">substring</span><span class="s8">(</span><span class="s14">1</span><span class="s8">,</span><span class="s1"> processedExpr</span><span class="s8">.</span><span class="s1">length </span><span class="s8">-</span><span class="s1"> </span><span class="s14">1</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>processedExpr </span><span class="s8">=</span><span class="s1"> processedExpr</span><span class="s8">.</span><span class="s1">replace</span><span class="s8">(</span><span class="s13">/\s/</span><span class="s12">g</span><span class="s8">,</span><span class="s1"> </span><span class="s9">''</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> terms </span><span class="s8">=</span><span class="s1"> processedExpr</span><span class="s8">.</span><span class="s1">match</span><span class="s8">(</span><span class="s13">/[+-]?[^+-]+/</span><span class="s12">g</span><span class="s8">)</span><span class="s1"> </span><span class="s8">||</span><span class="s1"> </span><span class="s8">[];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">terms</span><span class="s8">.</span><span class="s1">length </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s14">0</span><span class="s1"> </span><span class="s8">&amp;&amp;</span><span class="s1"> </span><span class="s8">!</span><span class="s13">/^[+-]/</span><span class="s8">.</span><span class="s1">test</span><span class="s8">(</span><span class="s1">terms</span><span class="s8">[</span><span class="s14">0</span><span class="s8">]))</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>terms</span><span class="s8">.</span><span class="s1">unshift</span><span class="s8">(</span><span class="s9">'+'</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> terms</span><span class="s8">.</span><span class="s1">shift</span><span class="s8">());</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> poly </span><span class="s8">=</span><span class="s1"> </span><span class="s8">[];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">for</span><span class="s1"> </span><span class="s8">(</span><span class="s12">const</span><span class="s1"> term </span><span class="s12">of</span><span class="s1"> terms</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">term</span><span class="s8">)</span><span class="s1"> </span><span class="s12">continue</span><span class="s8">;</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s4"> match </span><span class="s8">=</span><span class="s4"> term</span><span class="s8">.</span><span class="s4">match</span><span class="s8">(</span><span class="s1">/([+-]?\d*\.?\d*)\*?x?(?:\^\{?(-?\d*\.?\d*)\}?)?/</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">match</span><span class="s8">)</span><span class="s1"> </span><span class="s12">throw</span><span class="s1"> </span><span class="s12">new</span><span class="s1"> </span><span class="s7">Error</span><span class="s8">(</span><span class="s9">`Invalid polynomial term: </span><span class="s8">${</span><span class="s1">term</span><span class="s8">}</span><span class="s9">`</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">let</span><span class="s1"> coeffStr </span><span class="s8">=</span><span class="s1"> match</span><span class="s8">[</span><span class="s14">1</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> hasX </span><span class="s8">=</span><span class="s1"> match</span><span class="s8">[</span><span class="s14">0</span><span class="s8">].</span><span class="s1">includes</span><span class="s8">(</span><span class="s9">'x'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">let</span><span class="s1"> powerStr </span><span class="s8">=</span><span class="s1"> match</span><span class="s8">[</span><span class="s14">2</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">let</span><span class="s1"> coeff </span><span class="s8">=</span><span class="s1"> parseFloat</span><span class="s8">(</span><span class="s1">coeffStr</span><span class="s8">);</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">coeffStr </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'+'</span><span class="s1"> </span><span class="s8">||</span><span class="s1"> coeffStr </span><span class="s8">===</span><span class="s1"> </span><span class="s9">''</span><span class="s8">)</span><span class="s1"> coeff </span><span class="s8">=</span><span class="s1"> </span><span class="s14">1</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">coeffStr </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'-'</span><span class="s8">)</span><span class="s1"> coeff </span><span class="s8">=</span><span class="s1"> </span><span class="s8">-</span><span class="s14">1</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">isNaN</span><span class="s8">(</span><span class="s1">coeff</span><span class="s8">))</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                     </span></span><span class="s12">if</span><span class="s8">(</span><span class="s1">term</span><span class="s8">.</span><span class="s1">startsWith</span><span class="s8">(</span><span class="s9">'-'</span><span class="s8">))</span><span class="s1"> coeff </span><span class="s8">=</span><span class="s1"> </span><span class="s8">-</span><span class="s14">1</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">else</span><span class="s1"> coeff </span><span class="s8">=</span><span class="s1"> </span><span class="s14">1</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">let</span><span class="s1"> power </span><span class="s8">=</span><span class="s1"> </span><span class="s14">0</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">hasX</span><span class="s8">)</span><span class="s1"> power </span><span class="s8">=</span><span class="s1"> powerStr </span><span class="s8">?</span><span class="s1"> parseFloat</span><span class="s8">(</span><span class="s1">powerStr</span><span class="s8">)</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s14">1</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>poly</span><span class="s8">.</span><span class="s1">push</span><span class="s8">({</span><span class="s1"> coeff</span><span class="s8">,</span><span class="s1"> power </span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">return</span><span class="s1"> poly</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> formatPolynomial</span><span class="s8">(</span><span class="s1">poly</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> powerMap </span><span class="s8">=</span><span class="s1"> </span><span class="s12">new</span><span class="s1"> </span><span class="s7">Map</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">for</span><span class="s1"> </span><span class="s8">(</span><span class="s12">const</span><span class="s1"> </span><span class="s8">{</span><span class="s1"> coeff</span><span class="s8">,</span><span class="s1"> power </span><span class="s8">}</span><span class="s1"> </span><span class="s12">of</span><span class="s1"> poly</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>powerMap</span><span class="s8">.</span><span class="s12">set</span><span class="s8">(</span><span class="s1">power</span><span class="s8">,</span><span class="s1"> </span><span class="s8">(</span><span class="s1">powerMap</span><span class="s8">.</span><span class="s12">get</span><span class="s8">(</span><span class="s1">power</span><span class="s8">)</span><span class="s1"> </span><span class="s8">||</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> coeff</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> sortedTerms </span><span class="s8">=</span><span class="s1"> </span><span class="s7">Array</span><span class="s8">.</span><span class="s12">from</span><span class="s8">(</span><span class="s1">powerMap</span><span class="s8">.</span><span class="s1">entries</span><span class="s8">()).</span><span class="s1">sort</span><span class="s8">(([</span><span class="s1">p1</span><span class="s8">],</span><span class="s1"> </span><span class="s8">[</span><span class="s1">p2</span><span class="s8">])</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> p2 </span><span class="s8">-</span><span class="s1"> p1</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">sortedTerms</span><span class="s8">.</span><span class="s1">length </span><span class="s8">===</span><span class="s1"> </span><span class="s14">0</span><span class="s1"> </span><span class="s8">||</span><span class="s1"> sortedTerms</span><span class="s8">.</span><span class="s1">every</span><span class="s8">(([,</span><span class="s1"> c</span><span class="s8">])</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> c </span><span class="s8">===</span><span class="s1"> </span><span class="s14">0</span><span class="s8">))</span><span class="s1"> </span><span class="s12">return</span><span class="s1"> </span><span class="s9">'0'</span><span class="s8">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> result </span><span class="s8">=</span><span class="s1"> </span><span class="s9">''</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>sortedTerms</span><span class="s8">.</span><span class="s1">forEach</span><span class="s8">(([</span><span class="s1">power</span><span class="s8">,</span><span class="s1"> coeff</span><span class="s8">])</span><span class="s1"> </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">coeff </span><span class="s8">===</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s12">return</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> isFirst </span><span class="s8">=</span><span class="s1"> result </span><span class="s8">===</span><span class="s1"> </span><span class="s9">''</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> absCoeff </span><span class="s8">=</span><span class="s1"> </span><span class="s7">Math</span><span class="s8">.</span><span class="s1">abs</span><span class="s8">(</span><span class="s1">coeff</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">isFirst</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">coeff </span><span class="s8">&lt;</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> result </span><span class="s8">+=</span><span class="s1"> </span><span class="s9">'-'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>result </span><span class="s8">+=</span><span class="s1"> </span><span class="s8">(</span><span class="s1">coeff </span><span class="s8">&lt;</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s9">' - '</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s9">' + '</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">absCoeff </span><span class="s8">!==</span><span class="s1"> </span><span class="s14">1</span><span class="s1"> </span><span class="s8">||</span><span class="s1"> power </span><span class="s8">===</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>result </span><span class="s8">+=</span><span class="s1"> absCoeff</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">power </span><span class="s8">!==</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> result </span><span class="s8">+=</span><span class="s1"> </span><span class="s9">' '</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">power </span><span class="s8">===</span><span class="s1"> </span><span class="s14">1</span><span class="s8">)</span><span class="s1"> result </span><span class="s8">+=</span><span class="s1"> </span><span class="s9">'x'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">power </span><span class="s8">!==</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> result </span><span class="s8">+=</span><span class="s1"> </span><span class="s9">`x^{</span><span class="s8">${</span><span class="s1">power</span><span class="s8">}</span><span class="s9">}`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">return</span><span class="s1"> result</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> multiplyPolynomials</span><span class="s8">(</span><span class="s1">poly1</span><span class="s8">,</span><span class="s1"> poly2</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> resultPoly </span><span class="s8">=</span><span class="s1"> </span><span class="s8">[];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">for</span><span class="s1"> </span><span class="s8">(</span><span class="s12">const</span><span class="s1"> t1 </span><span class="s12">of</span><span class="s1"> poly1</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">for</span><span class="s1"> </span><span class="s8">(</span><span class="s12">const</span><span class="s1"> t2 </span><span class="s12">of</span><span class="s1"> poly2</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>resultPoly</span><span class="s8">.</span><span class="s1">push</span><span class="s8">({</span><span class="s1"> coeff</span><span class="s8">:</span><span class="s1"> t1</span><span class="s8">.</span><span class="s1">coeff </span><span class="s8">*</span><span class="s1"> t2</span><span class="s8">.</span><span class="s1">coeff</span><span class="s8">,</span><span class="s1"> power</span><span class="s8">:</span><span class="s1"> t1</span><span class="s8">.</span><span class="s1">power </span><span class="s8">+</span><span class="s1"> t2</span><span class="s8">.</span><span class="s1">power </span><span class="s8">});</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">return</span><span class="s1"> resultPoly</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> subtractPolynomials</span><span class="s8">(</span><span class="s1">poly1</span><span class="s8">,</span><span class="s1"> poly2</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> negatedPoly2 </span><span class="s8">=</span><span class="s1"> poly2</span><span class="s8">.</span><span class="s1">map</span><span class="s8">(</span><span class="s1">t </span><span class="s8">=&gt;</span><span class="s1"> </span><span class="s8">({</span><span class="s1"> coeff</span><span class="s8">:</span><span class="s1"> </span><span class="s8">-</span><span class="s1">t</span><span class="s8">.</span><span class="s1">coeff</span><span class="s8">,</span><span class="s1"> power</span><span class="s8">:</span><span class="s1"> t</span><span class="s8">.</span><span class="s1">power </span><span class="s8">}));</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">return</span><span class="s1"> </span><span class="s8">[...</span><span class="s1">poly1</span><span class="s8">,</span><span class="s1"> </span><span class="s8">...</span><span class="s1">negatedPoly2</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Core Derivative Logic (REWRITTEN &amp; FIXED) ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> calculateDerivative</span><span class="s8">(</span><span class="s1">expr</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> processedExpr </span><span class="s8">=</span><span class="s1"> expr</span><span class="s8">.</span><span class="s1">replace</span><span class="s8">(</span><span class="s13">/\\sqrt\((.*?)\)/</span><span class="s12">g</span><span class="s8">,</span><span class="s1"> </span><span class="s9">'($1)^(0.5)'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>processedExpr </span><span class="s8">=</span><span class="s1"> processedExpr</span><span class="s8">.</span><span class="s1">replace</span><span class="s8">(</span><span class="s13">/\\(sin|cos|tan|csc|sec|cot|ln)/</span><span class="s12">g</span><span class="s8">,</span><span class="s1"> </span><span class="s9">'$1'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>processedExpr </span><span class="s8">=</span><span class="s1"> processedExpr</span><span class="s8">.</span><span class="s1">replace</span><span class="s8">(</span><span class="s13">/\s/</span><span class="s12">g</span><span class="s8">,</span><span class="s1"> </span><span class="s9">''</span><span class="s8">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> terms </span><span class="s8">=</span><span class="s1"> processedExpr</span><span class="s8">.</span><span class="s1">match</span><span class="s8">(</span><span class="s13">/[+-]?[^+-]+/</span><span class="s12">g</span><span class="s8">)</span><span class="s1"> </span><span class="s8">||</span><span class="s1"> </span><span class="s8">[];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">             </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">terms</span><span class="s8">.</span><span class="s1">length </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s14">0</span><span class="s1"> </span><span class="s8">&amp;&amp;</span><span class="s1"> </span><span class="s8">!</span><span class="s13">/^[+-]/</span><span class="s8">.</span><span class="s1">test</span><span class="s8">(</span><span class="s1">terms</span><span class="s8">[</span><span class="s14">0</span><span class="s8">]))</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                 </span>terms</span><span class="s8">.</span><span class="s1">unshift</span><span class="s8">(</span><span class="s9">'+'</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> terms</span><span class="s8">.</span><span class="s1">shift</span><span class="s8">());</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> derivativeTerms </span><span class="s8">=</span><span class="s1"> </span><span class="s8">[];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">for</span><span class="s1"> </span><span class="s8">(</span><span class="s12">const</span><span class="s1"> term </span><span class="s12">of</span><span class="s1"> terms</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">term</span><span class="s8">)</span><span class="s1"> </span><span class="s12">continue</span><span class="s8">;</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s4"> trigMatch </span><span class="s8">=</span><span class="s4"> term</span><span class="s8">.</span><span class="s4">match</span><span class="s8">(</span><span class="s1">/([+-]?\d*\.?\d*)\*?(sin|cos|tan|csc|sec|cot)\(([xy])\)/</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> lnMatch </span><span class="s8">=</span><span class="s1"> term</span><span class="s8">.</span><span class="s1">match</span><span class="s8">(</span><span class="s13">/([+-]?\d*\.?\d*)\*?ln\(([xy])\)/</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">const</span><span class="s1"> eMatch </span><span class="s8">=</span><span class="s1"> term</span><span class="s8">.</span><span class="s1">match</span><span class="s8">(</span><span class="s13">/([+-]?\d*\.?\d*)\*?e\^\(([xy])\)/</span><span class="s8">);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">trigMatch</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">let</span><span class="s1"> coeffStr </span><span class="s8">=</span><span class="s1"> trigMatch</span><span class="s8">[</span><span class="s14">1</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> func </span><span class="s8">=</span><span class="s1"> trigMatch</span><span class="s8">[</span><span class="s14">2</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> variable </span><span class="s8">=</span><span class="s1"> trigMatch</span><span class="s8">[</span><span class="s14">3</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">let</span><span class="s1"> coeff </span><span class="s8">=</span><span class="s1"> parseFloat</span><span class="s8">(</span><span class="s1">coeffStr</span><span class="s8">)</span><span class="s1"> </span><span class="s8">||</span><span class="s1"> </span><span class="s8">(</span><span class="s1">coeffStr </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'-'</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s8">-</span><span class="s14">1</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s14">1</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">coeffStr </span><span class="s8">===</span><span class="s1"> </span><span class="s9">''</span><span class="s1"> </span><span class="s8">||</span><span class="s1"> coeffStr </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'+'</span><span class="s8">)</span><span class="s1"> coeff </span><span class="s8">=</span><span class="s1"> </span><span class="s14">1</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">coeff </span><span class="s8">===</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s12">continue</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">switch</span><span class="s1"> </span><span class="s8">(</span><span class="s1">func</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">case</span><span class="s1"> </span><span class="s9">'sin'</span><span class="s8">:</span><span class="s1"> derivativeTerms</span><span class="s8">.</span><span class="s1">push</span><span class="s8">(</span><span class="s1">formatCoeff</span><span class="s8">(</span><span class="s1">coeff</span><span class="s8">,</span><span class="s1"> derivativeTerms</span><span class="s8">.</span><span class="s1">length </span><span class="s8">===</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s9">`\\cos(</span><span class="s8">${</span><span class="s1">variable</span><span class="s8">}</span><span class="s9">)`</span><span class="s8">);</span><span class="s1"> </span><span class="s12">break</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">case</span><span class="s1"> </span><span class="s9">'cos'</span><span class="s8">:</span><span class="s1"> derivativeTerms</span><span class="s8">.</span><span class="s1">push</span><span class="s8">(</span><span class="s1">formatCoeff</span><span class="s8">(-</span><span class="s1">coeff</span><span class="s8">,</span><span class="s1"> derivativeTerms</span><span class="s8">.</span><span class="s1">length </span><span class="s8">===</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s9">`\\sin(</span><span class="s8">${</span><span class="s1">variable</span><span class="s8">}</span><span class="s9">)`</span><span class="s8">);</span><span class="s1"> </span><span class="s12">break</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">case</span><span class="s1"> </span><span class="s9">'tan'</span><span class="s8">:</span><span class="s1"> derivativeTerms</span><span class="s8">.</span><span class="s1">push</span><span class="s8">(</span><span class="s1">formatCoeff</span><span class="s8">(</span><span class="s1">coeff</span><span class="s8">,</span><span class="s1"> derivativeTerms</span><span class="s8">.</span><span class="s1">length </span><span class="s8">===</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s9">`\\sec^2(</span><span class="s8">${</span><span class="s1">variable</span><span class="s8">}</span><span class="s9">)`</span><span class="s8">);</span><span class="s1"> </span><span class="s12">break</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">case</span><span class="s1"> </span><span class="s9">'csc'</span><span class="s8">:</span><span class="s1"> derivativeTerms</span><span class="s8">.</span><span class="s1">push</span><span class="s8">(</span><span class="s1">formatCoeff</span><span class="s8">(-</span><span class="s1">coeff</span><span class="s8">,</span><span class="s1"> derivativeTerms</span><span class="s8">.</span><span class="s1">length </span><span class="s8">===</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s9">`\\csc(</span><span class="s8">${</span><span class="s1">variable</span><span class="s8">}</span><span class="s9">)\\cot(</span><span class="s8">${</span><span class="s1">variable</span><span class="s8">}</span><span class="s9">)`</span><span class="s8">);</span><span class="s1"> </span><span class="s12">break</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">case</span><span class="s1"> </span><span class="s9">'sec'</span><span class="s8">:</span><span class="s1"> derivativeTerms</span><span class="s8">.</span><span class="s1">push</span><span class="s8">(</span><span class="s1">formatCoeff</span><span class="s8">(</span><span class="s1">coeff</span><span class="s8">,</span><span class="s1"> derivativeTerms</span><span class="s8">.</span><span class="s1">length </span><span class="s8">===</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s9">`\\sec(</span><span class="s8">${</span><span class="s1">variable</span><span class="s8">}</span><span class="s9">)\\tan(</span><span class="s8">${</span><span class="s1">variable</span><span class="s8">}</span><span class="s9">)`</span><span class="s8">);</span><span class="s1"> </span><span class="s12">break</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">case</span><span class="s1"> </span><span class="s9">'cot'</span><span class="s8">:</span><span class="s1"> derivativeTerms</span><span class="s8">.</span><span class="s1">push</span><span class="s8">(</span><span class="s1">formatCoeff</span><span class="s8">(-</span><span class="s1">coeff</span><span class="s8">,</span><span class="s1"> derivativeTerms</span><span class="s8">.</span><span class="s1">length </span><span class="s8">===</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s9">`\\csc^2(</span><span class="s8">${</span><span class="s1">variable</span><span class="s8">}</span><span class="s9">)`</span><span class="s8">);</span><span class="s1"> </span><span class="s12">break</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">lnMatch</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">let</span><span class="s1"> coeffStr </span><span class="s8">=</span><span class="s1"> lnMatch</span><span class="s8">[</span><span class="s14">1</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> variable </span><span class="s8">=</span><span class="s1"> lnMatch</span><span class="s8">[</span><span class="s14">2</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">let</span><span class="s1"> coeff </span><span class="s8">=</span><span class="s1"> parseFloat</span><span class="s8">(</span><span class="s1">coeffStr</span><span class="s8">)</span><span class="s1"> </span><span class="s8">||</span><span class="s1"> </span><span class="s8">(</span><span class="s1">coeffStr </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'-'</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s8">-</span><span class="s14">1</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s14">1</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">coeffStr </span><span class="s8">===</span><span class="s1"> </span><span class="s9">''</span><span class="s1"> </span><span class="s8">||</span><span class="s1"> coeffStr </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'+'</span><span class="s8">)</span><span class="s1"> coeff </span><span class="s8">=</span><span class="s1"> </span><span class="s14">1</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">coeff </span><span class="s8">===</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s12">continue</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> num </span><span class="s8">=</span><span class="s1"> </span><span class="s7">Math</span><span class="s8">.</span><span class="s1">abs</span><span class="s8">(</span><span class="s1">coeff</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> sign </span><span class="s8">=</span><span class="s1"> coeff </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s14">0</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s8">(</span><span class="s1">derivativeTerms</span><span class="s8">.</span><span class="s1">length </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s14">0</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s9">'+ '</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s9">''</span><span class="s8">)</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s9">'- '</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>derivativeTerms</span><span class="s8">.</span><span class="s1">push</span><span class="s8">(</span><span class="s9">`</span><span class="s8">${</span><span class="s1">sign</span><span class="s8">}</span><span class="s9">\\frac{</span><span class="s8">${</span><span class="s1">num</span><span class="s8">}</span><span class="s9">}{</span><span class="s8">${</span><span class="s1">variable</span><span class="s8">}</span><span class="s9">}`</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">eMatch</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">let</span><span class="s1"> coeffStr </span><span class="s8">=</span><span class="s1"> eMatch</span><span class="s8">[</span><span class="s14">1</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> variable </span><span class="s8">=</span><span class="s1"> eMatch</span><span class="s8">[</span><span class="s14">2</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">let</span><span class="s1"> coeff </span><span class="s8">=</span><span class="s1"> parseFloat</span><span class="s8">(</span><span class="s1">coeffStr</span><span class="s8">)</span><span class="s1"> </span><span class="s8">||</span><span class="s1"> </span><span class="s8">(</span><span class="s1">coeffStr </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'-'</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s8">-</span><span class="s14">1</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s14">1</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">coeffStr </span><span class="s8">===</span><span class="s1"> </span><span class="s9">''</span><span class="s1"> </span><span class="s8">||</span><span class="s1"> coeffStr </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'+'</span><span class="s8">)</span><span class="s1"> coeff </span><span class="s8">=</span><span class="s1"> </span><span class="s14">1</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">coeff </span><span class="s8">===</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s12">continue</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>derivativeTerms</span><span class="s8">.</span><span class="s1">push</span><span class="s8">(</span><span class="s1">formatCoeff</span><span class="s8">(</span><span class="s1">coeff</span><span class="s8">,</span><span class="s1"> derivativeTerms</span><span class="s8">.</span><span class="s1">length </span><span class="s8">===</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> </span><span class="s9">`e^{</span><span class="s8">${</span><span class="s1">variable</span><span class="s8">}</span><span class="s9">}`</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p8"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s4"> match </span><span class="s8">=</span><span class="s4"> term</span><span class="s8">.</span><span class="s4">match</span><span class="s8">(</span><span class="s1">/([+-]?\d*\.?\d*)\*?([xy])?(?:\^\(?(-?\d*\.?\d*)\)?)?/</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">match</span><span class="s8">)</span><span class="s1"> </span><span class="s12">continue</span><span class="s8">;</span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s4"> </span><span class="s8">(!</span><span class="s4">match</span><span class="s8">[</span><span class="s14">2</span><span class="s8">])</span><span class="s4"> </span><span class="s12">continue</span><span class="s8">;</span><span class="s4"> </span><span class="s1">// It's a constant, derivative is 0</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">let</span><span class="s1"> coeffStr </span><span class="s8">=</span><span class="s1"> match</span><span class="s8">[</span><span class="s14">1</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> variable </span><span class="s8">=</span><span class="s1"> match</span><span class="s8">[</span><span class="s14">2</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">let</span><span class="s1"> powerStr </span><span class="s8">=</span><span class="s1"> match</span><span class="s8">[</span><span class="s14">3</span><span class="s8">];</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">let</span><span class="s1"> coeff </span><span class="s8">=</span><span class="s1"> parseFloat</span><span class="s8">(</span><span class="s1">coeffStr</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                     </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">coeffStr </span><span class="s8">===</span><span class="s1"> </span><span class="s9">''</span><span class="s1"> </span><span class="s8">||</span><span class="s1"> coeffStr </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'+'</span><span class="s8">)</span><span class="s1"> coeff </span><span class="s8">=</span><span class="s1"> </span><span class="s14">1</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                     </span></span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">coeffStr </span><span class="s8">===</span><span class="s1"> </span><span class="s9">'-'</span><span class="s8">)</span><span class="s1"> coeff </span><span class="s8">=</span><span class="s1"> </span><span class="s8">-</span><span class="s14">1</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                     </span></span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">isNaN</span><span class="s8">(</span><span class="s1">coeff</span><span class="s8">))</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                         </span>coeff </span><span class="s8">=</span><span class="s1"> term</span><span class="s8">.</span><span class="s1">startsWith</span><span class="s8">(</span><span class="s9">'-'</span><span class="s8">)</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s8">-</span><span class="s14">1</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s14">1</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                     </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">let</span><span class="s1"> power </span><span class="s8">=</span><span class="s1"> powerStr </span><span class="s8">?</span><span class="s1"> parseFloat</span><span class="s8">(</span><span class="s1">powerStr</span><span class="s8">)</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s14">1</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> newCoeff </span><span class="s8">=</span><span class="s1"> coeff </span><span class="s8">*</span><span class="s1"> power</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> newPower </span><span class="s8">=</span><span class="s1"> power </span><span class="s8">-</span><span class="s1"> </span><span class="s14">1</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">newCoeff </span><span class="s8">===</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s12">continue</span><span class="s8">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">let</span><span class="s1"> newTerm </span><span class="s8">=</span><span class="s1"> </span><span class="s9">''</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> isFirst </span><span class="s8">=</span><span class="s1"> derivativeTerms</span><span class="s8">.</span><span class="s1">length </span><span class="s8">===</span><span class="s1"> </span><span class="s14">0</span><span class="s8">;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">                    </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(!</span><span class="s1">isFirst</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>newTerm </span><span class="s8">+=</span><span class="s1"> newCoeff </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s14">0</span><span class="s1"> </span><span class="s8">?</span><span class="s1"> </span><span class="s9">'+ '</span><span class="s1"> </span><span class="s8">:</span><span class="s1"> </span><span class="s9">' - '</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">newCoeff </span><span class="s8">&lt;</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>newTerm </span><span class="s8">+=</span><span class="s1"> </span><span class="s9">'-'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">const</span><span class="s1"> absCoeff </span><span class="s8">=</span><span class="s1"> </span><span class="s7">Math</span><span class="s8">.</span><span class="s1">abs</span><span class="s8">(</span><span class="s1">newCoeff</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">absCoeff </span><span class="s8">!==</span><span class="s1"> </span><span class="s14">1</span><span class="s1"> </span><span class="s8">||</span><span class="s1"> newPower </span><span class="s8">===</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>newTerm </span><span class="s8">+=</span><span class="s1"> absCoeff</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">newPower </span><span class="s8">!==</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> newTerm </span><span class="s8">+=</span><span class="s1"> </span><span class="s9">' '</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">newPower </span><span class="s8">===</span><span class="s1"> </span><span class="s14">1</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>newTerm </span><span class="s8">+=</span><span class="s1"> variable</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">newPower </span><span class="s8">!==</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                        </span>newTerm </span><span class="s8">+=</span><span class="s1"> </span><span class="s9">`</span><span class="s8">${</span><span class="s1">variable</span><span class="s8">}</span><span class="s9">^{</span><span class="s8">${</span><span class="s1">newPower</span><span class="s8">}</span><span class="s9">}`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                    </span>derivativeTerms</span><span class="s8">.</span><span class="s1">push</span><span class="s8">(</span><span class="s1">newTerm</span><span class="s8">.</span><span class="s1">trim</span><span class="s8">());</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">derivativeTerms</span><span class="s8">.</span><span class="s1">length </span><span class="s8">===</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s12">return</span><span class="s1"> </span><span class="s9">'0'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">let</span><span class="s1"> result </span><span class="s8">=</span><span class="s1"> derivativeTerms</span><span class="s8">.</span><span class="s1">join</span><span class="s8">(</span><span class="s9">''</span><span class="s8">).</span><span class="s1">trim</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">result</span><span class="s8">.</span><span class="s1">startsWith</span><span class="s8">(</span><span class="s9">'+ '</span><span class="s8">))</span><span class="s1"> result </span><span class="s8">=</span><span class="s1"> result</span><span class="s8">.</span><span class="s1">substring</span><span class="s8">(</span><span class="s14">2</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">return</span><span class="s1"> result</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p6"><span class="s4"><span class="Apple-converted-space">        </span></span><span class="s1">// --- Helper Functions ---</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> insertFunctionWithCursor</span><span class="s8">(</span><span class="s1">funcName</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> text </span><span class="s8">=</span><span class="s1"> funcName </span><span class="s8">+</span><span class="s1"> </span><span class="s9">'()'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>insertAtCursor</span><span class="s8">(</span><span class="s1">text</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>activeInput</span><span class="s8">.</span><span class="s1">selectionStart </span><span class="s8">-=</span><span class="s1"> </span><span class="s14">1</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>activeInput</span><span class="s8">.</span><span class="s1">selectionEnd </span><span class="s8">=</span><span class="s1"> activeInput</span><span class="s8">.</span><span class="s1">selectionStart</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> insertAtCursor</span><span class="s8">(</span><span class="s1">myValue</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> startPos </span><span class="s8">=</span><span class="s1"> activeInput</span><span class="s8">.</span><span class="s1">selectionStart</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> endPos </span><span class="s8">=</span><span class="s1"> activeInput</span><span class="s8">.</span><span class="s1">selectionEnd</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>activeInput</span><span class="s8">.</span><span class="s1">value </span><span class="s8">=</span><span class="s1"> activeInput</span><span class="s8">.</span><span class="s1">value</span><span class="s8">.</span><span class="s1">substring</span><span class="s8">(</span><span class="s14">0</span><span class="s8">,</span><span class="s1"> startPos</span><span class="s8">)</span><span class="s1"> </span><span class="s8">+</span><span class="s1"> myValue </span><span class="s8">+</span><span class="s1"> activeInput</span><span class="s8">.</span><span class="s1">value</span><span class="s8">.</span><span class="s1">substring</span><span class="s8">(</span><span class="s1">endPos</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>activeInput</span><span class="s8">.</span><span class="s1">selectionStart </span><span class="s8">=</span><span class="s1"> activeInput</span><span class="s8">.</span><span class="s1">selectionEnd </span><span class="s8">=</span><span class="s1"> startPos </span><span class="s8">+</span><span class="s1"> myValue</span><span class="s8">.</span><span class="s1">length</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>activeInput</span><span class="s8">.</span><span class="s1">focus</span><span class="s8">();</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> formatCoeff</span><span class="s8">(</span><span class="s1">coeff</span><span class="s8">,</span><span class="s1"> isFirstTerm </span><span class="s8">=</span><span class="s1"> </span><span class="s12">false</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">isFirstTerm</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">coeff </span><span class="s8">===</span><span class="s1"> </span><span class="s14">1</span><span class="s8">)</span><span class="s1"> </span><span class="s12">return</span><span class="s1"> </span><span class="s9">''</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">coeff </span><span class="s8">===</span><span class="s1"> </span><span class="s8">-</span><span class="s14">1</span><span class="s8">)</span><span class="s1"> </span><span class="s12">return</span><span class="s1"> </span><span class="s9">'-'</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">return</span><span class="s1"> </span><span class="s9">`</span><span class="s8">${</span><span class="s1">coeff</span><span class="s8">.</span><span class="s1">toLocaleString</span><span class="s8">()}</span><span class="s9"> `</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span><span class="s1"> </span><span class="s12">else</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">coeff </span><span class="s8">===</span><span class="s1"> </span><span class="s14">1</span><span class="s8">)</span><span class="s1"> </span><span class="s12">return</span><span class="s1"> </span><span class="s9">'+ '</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">coeff </span><span class="s8">===</span><span class="s1"> </span><span class="s8">-</span><span class="s14">1</span><span class="s8">)</span><span class="s1"> </span><span class="s12">return</span><span class="s1"> </span><span class="s9">' - '</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">if</span><span class="s1"> </span><span class="s8">(</span><span class="s1">coeff </span><span class="s8">&gt;</span><span class="s1"> </span><span class="s14">0</span><span class="s8">)</span><span class="s1"> </span><span class="s12">return</span><span class="s1"> </span><span class="s9">`+ </span><span class="s8">${</span><span class="s1">coeff</span><span class="s8">.</span><span class="s1">toLocaleString</span><span class="s8">()}</span><span class="s9"> `</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span></span><span class="s12">return</span><span class="s1"> </span><span class="s9">` - </span><span class="s8">${</span><span class="s7">Math</span><span class="s8">.</span><span class="s1">abs</span><span class="s8">(</span><span class="s1">coeff</span><span class="s8">).</span><span class="s1">toLocaleString</span><span class="s8">()}</span><span class="s9"> `</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> displayResult</span><span class="s8">(</span><span class="s1">answerEl</span><span class="s8">,</span><span class="s1"> derivative</span><span class="s8">,</span><span class="s1"> ruleName </span><span class="s8">=</span><span class="s1"> </span><span class="s9">"f'(x,y) ="</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>answerEl</span><span class="s8">.</span><span class="s4">innerHTML </span><span class="s8">=</span><span class="s4"> </span><span class="s1">`&lt;p class="font-semibold text-gray-700"&gt;</span><span class="s8">${</span><span class="s4">ruleName</span><span class="s8">}</span><span class="s1">&lt;/p&gt;&lt;div class="math-preview"&gt;&lt;/div&gt;`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">const</span><span class="s1"> preview </span><span class="s8">=</span><span class="s1"> answerEl</span><span class="s8">.</span><span class="s1">querySelector</span><span class="s8">(</span><span class="s9">'.math-preview'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span>typeset</span><span class="s8">(</span><span class="s1">preview</span><span class="s8">,</span><span class="s1"> derivative</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s12">function</span><span class="s1"> displayError</span><span class="s8">(</span><span class="s1">answerEl</span><span class="s8">,</span><span class="s1"> message</span><span class="s8">,</span><span class="s1"> inputEl </span><span class="s8">=</span><span class="s1"> </span><span class="s12">null</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p7"><span class="s4"><span class="Apple-converted-space">            </span>answerEl</span><span class="s8">.</span><span class="s4">innerHTML </span><span class="s8">=</span><span class="s4"> </span><span class="s1">`&lt;p class="text-red-500 font-medium"&gt;</span><span class="s8">${</span><span class="s4">message</span><span class="s8">}</span><span class="s1">&lt;/p&gt;`</span><span class="s8">;</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s12">if</span><span class="s8">(</span><span class="s1">inputEl</span><span class="s8">)</span><span class="s1"> </span><span class="s8">{</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">                </span>inputEl</span><span class="s8">.</span><span class="s1">classList</span><span class="s8">.</span><span class="s1">add</span><span class="s8">(</span><span class="s9">'border-red-500'</span><span class="s8">);</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">            </span></span><span class="s8">}</span></p>
<p class="p4"><span class="s1"><span class="Apple-converted-space">        </span></span><span class="s8">}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">        </span></span></p>
<p class="p1"><span class="s4"><span class="Apple-converted-space">    </span></span><span class="s3">&lt;/</span><span class="s1">script</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">body</span><span class="s3">&gt;</span></p>
<p class="p1"><span class="s3">&lt;/</span><span class="s1">html</span><span class="s3">&gt;</span></p>
<p class="p5"><span class="s10"></span><br></p>
<p class="p5"><span class="s10"></span><br></p>
</body>
</html>
